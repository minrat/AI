import tensorflow as tf

# 样本数据
x_data = [1, 2, 3]
y_data = [1, 2, 3]

# 构建变量
W = tf.Variable(tf.random_uniform([1], -1.0, 1.0))
b = tf.Variable(tf.random_uniform([1], -1.0, 1.0))

# 算法函数
hypothesis = W * x_data + b

cost = tf.reduce_mean(tf.square(hypothesis - y_data))

a = tf.Variable(0.1)
optimizer = tf.train.GradientDescentOptimizer(a)
train = optimizer.minimize(cost)

init = tf.global_variables_initializer()

sess = tf.Session()
sess.run(init)

for step in range(1001):
    sess.run(train)
    if step % 20 == 0:
        print(step, sess.run(cost), sess.run(W), sess.run(b))
        
        
        2019-03-03 13:36:14.735961: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2
0 0.1001603 [0.68191874] [0.81702125]
20 0.03484434 [0.7831986] [0.49284053]
40 0.013165136 [0.8667373] [0.30293736]
60 0.0049741375 [0.91808665] [0.18620847]
80 0.0018793681 [0.94964975] [0.11445791]
100 0.00071007386 [0.96905094] [0.07035456]
120 0.0002682834 [0.9809764] [0.04324526]
140 0.00010136407 [0.98830664] [0.0265818]
160 3.8298662e-05 [0.99281234] [0.01633918]
180 1.4469889e-05 [0.9955819] [0.01004333]
200 5.4673687e-06 [0.9972843] [0.00617338]
220 2.0656069e-06 [0.9983307] [0.00379464]
240 7.8050334e-07 [0.9989739] [0.00233247]
260 2.9489618e-07 [0.9993693] [0.00143374]
280 1.11442e-07 [0.9996123] [0.00088129]
300 4.2080448e-08 [0.9997617] [0.0005417]
320 1.5907764e-08 [0.9998535] [0.00033297]
340 6.0086194e-09 [0.99990994] [0.00020462]
360 2.2708992e-09 [0.9999446] [0.00012578]
380 8.6138624e-10 [0.999966] [7.7348624e-05]
400 3.24088e-10 [0.9999791] [4.753042e-05]
420 1.2199071e-10 [0.9999871] [2.9227818e-05]
440 4.6673183e-11 [0.99999213] [1.7958566e-05]
460 1.7754095e-11 [0.9999952] [1.1044426e-05]
480 6.915949e-12 [0.999997] [6.7767346e-06]
500 2.4679518e-12 [0.99999815] [4.1620774e-06]
520 8.7159907e-13 [0.99999887] [2.5567265e-06]
540 3.2684966e-13 [0.9999993] [1.563316e-06]
560 1.563194e-13 [0.9999996] [9.593228e-07]
580 6.158037e-14 [0.99999964] [7.050099e-07]
600 6.158037e-14 [0.99999976] [5.7785337e-07]
620 3.7895614e-14 [0.9999999] [3.3943473e-07]
640 4.7369517e-15 [0.99999994] [1.486998e-07]
660 0.0 [1.] [5.333235e-08]
680 0.0 [1.] [5.333235e-08]
700 0.0 [1.] [5.333235e-08]
720 0.0 [1.] [5.333235e-08]
740 0.0 [1.] [5.333235e-08]
760 0.0 [1.] [5.333235e-08]
780 0.0 [1.] [5.333235e-08]
800 0.0 [1.] [5.333235e-08]
820 0.0 [1.] [5.333235e-08]
840 0.0 [1.] [5.333235e-08]
860 0.0 [1.] [5.333235e-08]
880 0.0 [1.] [5.333235e-08]
900 0.0 [1.] [5.333235e-08]
920 0.0 [1.] [5.333235e-08]
940 0.0 [1.] [5.333235e-08]
960 0.0 [1.] [5.333235e-08]
980 0.0 [1.] [5.333235e-08]
1000 0.0 [1.] [5.333235e-08]
